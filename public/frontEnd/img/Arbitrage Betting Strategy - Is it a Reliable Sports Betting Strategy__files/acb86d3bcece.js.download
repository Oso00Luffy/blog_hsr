(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{800:function(e,t,r){"use strict";r.r(t),function(e){var n,o,c,d=r(19),f=r(0),h=(r(7),r(29),r(18),r(33),r(22),r(28),r(120)),l=r(144),m=r(23);t.default={nuxtServerInit:function(t,r){return Object(f.a)(regeneratorRuntime.mark((function x(){var _,k,y,S,w,E,C,v,T,R,O,D,A,j,I,L,B,U,z,F,$,G,H,N,P,W,J,M,X,V,K,Z,Q,Y;return regeneratorRuntime.wrap((function(x){for(;;)switch(x.prev=x.next){case 0:return Y=function(){return(Y=Object(f.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!L.access_token){e.next=26;break}return R.setToken(L.access_token,"Bearer"),e.next=4,O.fetchUser();case 4:if(!e.sent){e.next=13;break}if(O.persistAuthState({accessToken:L.access_token,accessTokenExpires:L.access_token_expires}),!O.isTokenExpiringSoon()||!L.refresh_token){e.next=10;break}return e.next=10,O.refreshToken(L.refresh_token);case 10:return e.abrupt("return",!0);case 13:if(!L.refresh_token){e.next=21;break}return e.next=16,O.refreshToken(L.refresh_token);case 16:return e.next=18,O.fetchUser();case 18:case 31:return e.abrupt("return",e.sent);case 21:return e.next=23,O.reset();case 23:case 32:return e.abrupt("return",!1);case 24:e.next=32;break;case 26:if(!L.refresh_token){e.next=32;break}return e.next=29,O.refreshToken(L.refresh_token);case 29:return e.next=31,O.fetchUser();case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)},Q=function(){return Y.apply(this,arguments)},Z=function(){return Z=Object(f.a)(regeneratorRuntime.mark((function t(){var r,d,l,x,_;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_=function(e){var t="decimal";try{return Object(m.a)(t,[e,"oddType"],h.a)}catch(e){return t}},x=function(){return x=Object(f.a)(regeneratorRuntime.mark((function t(){var r,d,h,l,x,k,y,E,C,v,T,R,O,D;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return D=function(){return(D=Object(f.a)(regeneratorRuntime.mark((function t(){var data,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.readFile(e.cwd()+"/geolocation/GeoLite2-City.mmdb");case 2:return data=t.sent,r=n.openBuffer(data),t.abrupt("return",r.city(x));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)},O=function(){return D.apply(this,arguments)},R=function(){return(R=Object(f.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S.headers["cf-ipcountry"]||2!==S.headers["cf-ipcountry"].length||["xx","t1"].includes(S.headers["cf-ipcountry"].toLowerCase())){e.next=2;break}return e.abrupt("return",S.headers["cf-ipcountry"]);case 2:if(e.prev=2,x){e.next=5;break}return e.abrupt("return",h);case 5:if(r){e.next=9;break}return e.next=8,O();case 8:r=e.sent;case 9:return e.abrupt("return",Object(m.a)(h,["country","isoCode"],r));case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",h);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)},T=function(){return R.apply(this,arguments)},v=function(){return(v=Object(f.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"us"===w.i18n.locale&&x){e.next=3;break}return e.abrupt("return",l);case 3:if(r){e.next=7;break}return e.next=6,O();case 6:r=e.sent;case 7:return e.abrupt("return",Object(m.a)(l,["subdivisions",0,"isoCode"],r));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",l);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)},C=function(){return v.apply(this,arguments)},E=function(){return(E=Object(f.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,x){e.next=3;break}return e.abrupt("return",d);case 3:if(r){e.next=7;break}return e.next=6,O();case 6:r=e.sent;case 7:return e.abrupt("return",Object(m.a)(d,["location","timeZone"],r));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",d);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)},y=function(){return E.apply(this,arguments)},d="UTC",h="",l="",x=c.getClientIp(S),t.next=14,T();case 14:if(k=t.sent,t.t0=k,!L.user_metro_code){t.next=20;break}t.t1=L.user_metro_code,t.next=23;break;case 20:return t.next=22,C();case 22:t.t1=t.sent;case 23:if(t.t2=t.t1,t.t3=L.user_country?L.user_country:k,!L.user_timezone){t.next=29;break}t.t4=L.user_timezone,t.next=32;break;case 29:return t.next=31,y(k);case 31:t.t4=t.sent;case 32:return t.t5=t.t4,t.t6=L.user_odds_format?L.user_odds_format:_(k),t.t7=L.user_wettsteuer_enabled?L.user_wettsteuer_enabled:0,t.abrupt("return",{geoCode:t.t0,stateCode:t.t2,bookmakersGeoCode:t.t3,timezone:t.t5,oddsFormat:t.t6,wettsteuer:t.t7});case 36:case"end":return t.stop()}}),t)}))),x.apply(this,arguments)},l=function(){return x.apply(this,arguments)},d=function(){var e=S.headers["x-country-code"]||"all",t=S.headers["x-bookmakers-country-code"]||"all";return["XX","T1"].includes(e)&&(e=""),["XX","T1"].includes(t)&&(t=""),{geoCode:e,stateCode:S.headers["x-metro-code"],bookmakersGeoCode:t,timezone:S.headers["x-timezone"],oddsFormat:S.headers["x-odds-format"],wettsteuer:S.headers["x-wettsteuer-enabled"],device:S.headers["x-device-type"],isBot:S.headers["x-is-bot"]}},r=function(){return{geoCode:"DE",stateCode:"",bookmakersGeoCode:L.user_country?L.user_country:"DE",timezone:L.user_timezone?L.user_timezone:"UTC",oddsFormat:L.user_odds_format?L.user_odds_format:_("DE"),wettsteuer:L.user_wettsteuer_enabled?L.user_wettsteuer_enabled:0}},"local"!==E.appEnv){t.next=9;break}return t.abrupt("return",r());case 9:if(!F){t.next=13;break}t.t0=d(),t.next=16;break;case 13:return t.next=15,l();case 15:t.t0=t.sent;case 16:return t.abrupt("return",t.t0);case 17:case"end":return t.stop()}}),t)}))),Z.apply(this,arguments)},K=function(){return Z.apply(this,arguments)},V=function(){return(V=Object(f.a)(regeneratorRuntime.mark((function t(){var r,n,c,d,f,h,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="countries:".concat(w.i18n.locale),v.start("cache:get ".concat(r)),t.next=4,T.get(r);case 4:if(n=t.sent,v.finish("cache:get ".concat(r)),Array.isArray(n)){t.next=17;break}return c="countries_".concat(w.i18n.locale,".json"),v.start("fileread: ".concat(c)),t.next=11,o.readJson(e.cwd()+"/app/config/".concat(c));case 11:return n=t.sent,v.finish("fileread: ".concat(c)),v.start("cache:set ".concat(r)),t.next=16,T.set(r,n);case 16:v.finish("cache:set ".concat(r));case 17:return _("config/SET_COUNTRIES",n),d="states:us",v.start("cache:get ".concat(d)),t.next=22,T.get(d);case 22:if(f=t.sent,v.finish("cache:get ".concat(d)),Array.isArray(f)){t.next=35;break}return h="states_us.json",v.start("fileread: ".concat(h)),t.next=29,o.readJson(e.cwd()+"/app/config/".concat(h));case 29:return f=t.sent,v.finish("fileread: ".concat(h)),v.start("cache:set ".concat(d)),t.next=34,T.set(d,f);case 34:v.finish("cache:set ".concat(d));case 35:return _("config/SET_US_STATES",f),t.next=38,k("timezone/switchTz",N.timezone);case 38:if(!(F?"yes"===N.isBot:w.$device.isCrawler)){t.next=47;break}return t.next=42,k("user/setCountry","");case 42:if("us"!==w.i18n.locale){t.next=45;break}return t.next=45,k("user/setCountryState","");case 45:t.next=54;break;case 47:return l=N.bookmakersGeoCode,"us"!==w.i18n.locale&&"ca"!==l.toLowerCase()||(l="us"),t.next=51,k("user/setCountry","all"===l?"":l);case 51:if("us"!==w.i18n.locale){t.next=54;break}return t.next=54,k("user/setCountryState","all"===N.stateCode?"":N.stateCode);case 54:return t.next=56,k("geolocation/setCountry",N.geoCode);case 56:return t.next=58,k("event/setLivestreamCountryCode",y["user/countryCode"]);case 58:return _("SET_ODDS_FORMAT",N.oddsFormat),y["tax/isWettsteuerSupported"]&&_("tax/SET_WETTSTEUER_ENABLED",N.wettsteuer),t.next=62,k("event/setupCampaignBanner",{headers:S.headers,user:N});case 62:case"end":return t.stop()}}),t)})))).apply(this,arguments)},X=function(){return V.apply(this,arguments)},M=function(){return(M=Object(f.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[k("allSports/getAllSports",{geoCode:N.geoCode}),k("bookmakers/fetchAllBookmakers")],H&&t.push(D.fetch(!0)),t.push(k("betslip/fetch",!1)),(n=Object(l.a)(r))&&t.push(k("globals/fetchData",{payload:n,error:C})),e.next=7,Promise.all(t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},J=function(){return M.apply(this,arguments)},W=function(){return(W=Object(f.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v.start("fetchData"),e.next=3,J();case 3:return v.finish("fetchData"),v.start("populateStore"),e.next=7,X();case 7:v.finish("populateStore");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)},P=function(){return W.apply(this,arguments)},_=t.commit,k=t.dispatch,y=t.getters,S=r.req,w=r.app,E=r.env,C=r.error,v=r.$SentryHelper,T=r.$CacheHelper,R=r.$axios,O=r.$auth,D=r.$favorites,A=r.$config,v.start("nuxtServerInit"),j="string"==typeof S.headers["user-agent"]&&S.headers["user-agent"].includes("oddspedia-bypass-cache-api"),t.commit("api/SET_IS_CACHE_DISABLED",j),I="string"==typeof S.headers["user-agent"]&&S.headers["user-agent"].includes("oddspedia-debug-api"),t.commit("api/SET_IS_DEBUG_ENABLED",I),"string"==typeof S.headers["user-agent"]&&S.headers["user-agent"].includes("oddspedia-debug-and-bypass-cache-api")&&(t.commit("api/SET_IS_CACHE_DISABLED",!0),t.commit("api/SET_IS_DEBUG_ENABLED",!0)),L=undefined.parse(S),x.next=22,t.dispatch("experiments/setup",{cookies:L,headers:S.headers});case 22:return B="true"===L["accept-cookies"],_("SET_COOKIES_ACCEPT",B),U="true"===L.world_cup_countdown_closed,_("SET_WORLD_CUP_COUNTDOWN_CLOSED",U),z="production"!==E.appEnv||"string"==typeof S.headers["user-agent"]&&S.headers["user-agent"].includes("oddspedia-"),_("SET_MERCURE_LOGS_ENABLED",z),B||k("cookies-popup/selectRandomImage"),F=!!S.headers["x-varnish"],_("SET_IS_SERVED_WITH_VARNISH",F),O.setStoreSSR(t),k("betslip/restore"),x.next=35,Promise.all([Q(),K()]);case 35:return $=x.sent,G=Object(d.a)($,2),H=G[0],N=G[1],O.isLoggedIn&&(N.timezone=O.user.settings.timezone,N.oddsFormat=O.user.settings.odds_format,N.stateCode=O.user.settings.bookmakers_state||"all",N.bookmakersGeoCode=O.user.settings.bookmakers_country||"all",A.mathTag.enabled&&O.user.email&&t.commit("mathtag/SET_USER_EMAIL_HASH",undefined.createHash("sha256").update(O.user.email,"utf-8").digest("hex"))),x.next=42,P();case 42:v.finish("nuxtServerInit");case 43:case"end":return x.stop()}}),x)})))()},switchOddsFormat:function(e,t){var r=this;return Object(f.a)(regeneratorRuntime.mark((function n(){var o,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.commit,c="decimal",["decimal","fractional","american"].includes(t)&&(c=t),o("SET_ODDS_FORMAT",c),(d=[]).push(r.$api.session.setOddsFormat(c)),r.$auth.isLoggedIn&&d.push(r.$api.auth.update({odds_format:c})),n.next=11,Promise.all(d);case 11:case"end":return n.stop()}}),n)})))()}}}.call(this,r(99))}}]);